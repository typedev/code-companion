# v0.2 Plan: Session Content Viewer

## Goal

Display full session content when a session is selected: user messages, assistant responses, thinking blocks, and tool calls.

## Checkpoints

### Checkpoint 1: Data layer for full session parsing
- [x] Extend `Session` model with `messages: list[Message]`
- [x] Create `Message` dataclass (type, content, timestamp)
- [x] Create `ToolCall` dataclass (tool name, input, output)
- [x] Add `HistoryService.load_session_content()` method
- [x] Parse all event types: user, assistant, tool_use, tool_result

### Checkpoint 2: Message widget
- [x] Create `MessageRow` widget for displaying a single message
- [x] Style user vs assistant messages differently
- [x] Handle text content with proper escaping
- [ ] Support markdown in messages (basic: code blocks, bold, italic) â€” DEFERRED

### Checkpoint 3: Tool call display
- [x] Create `ToolCallCard` widget
- [x] Show tool name with icon (Read, Edit, Write, Bash, Glob, Grep)
- [x] Show file path or command as subtitle
- [x] Collapsible for now (details in v0.2.1)

### Checkpoint 4: Thinking block
- [x] Create `ThinkingBlock` widget
- [x] Collapsed by default with "Thinking..." label
- [x] Expandable to show full thinking content
- [x] Styled as dimmed/muted text

### Checkpoint 5: Session view integration
- [x] Create `SessionView` widget (scrollable message list)
- [x] Add third panel or replace session list on selection
- [x] Wire up session selection to load and display content
- [x] Handle loading state

## File Structure

```
src/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ message.py      # Message dataclass
â”‚   â””â”€â”€ tool_call.py    # ToolCall dataclass
â”œâ”€â”€ widgets/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ session_view.py    # Full session display
â”‚   â”œâ”€â”€ message_row.py     # Single message widget
â”‚   â”œâ”€â”€ tool_call_card.py  # Tool call card
â”‚   â””â”€â”€ thinking_block.py  # Collapsible thinking
â””â”€â”€ services/
    â””â”€â”€ history.py      # Extended with load_session_content()
```

## UI Layout

When session selected, replace session list with session content:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Projects         â”‚ â† Back    Session: Dec 11, 14:30       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ > my-project     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   other-project  â”‚ â”‚ ğŸ‘¤ Fix the login bug                â”‚ â”‚
â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                                         â”‚
â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                  â”‚ â”‚ ğŸ¤– I'll analyze the auth module...  â”‚ â”‚
â”‚                  â”‚ â”‚                                     â”‚ â”‚
â”‚                  â”‚ â”‚ â–¶ Thinking...                       â”‚ â”‚
â”‚                  â”‚ â”‚                                     â”‚ â”‚
â”‚                  â”‚ â”‚ ğŸ“– Read src/auth.py                 â”‚ â”‚
â”‚                  â”‚ â”‚ âœï¸ Edit src/auth.py                 â”‚ â”‚
â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                  â”‚                                         â”‚
â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                  â”‚ â”‚ ğŸ‘¤ Now add tests                    â”‚ â”‚
â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Tool Icons

| Tool | Icon |
|------|------|
| Read | document-open-symbolic |
| Edit | document-edit-symbolic |
| Write | document-new-symbolic |
| Bash | utilities-terminal-symbolic |
| Glob | folder-saved-search-symbolic |
| Grep | edit-find-symbolic |
| Task | system-run-symbolic |
| WebFetch | web-browser-symbolic |

## Progress

- Started: 2025-12-11
- Current checkpoint: 5 (all complete)
- Status: DONE

### Notes

All checkpoints completed. Markdown support deferred to future version.
Session viewer now shows messages with:
- User/Assistant differentiation with emoji icons
- Collapsible thinking blocks
- Tool call cards with icons and subtitles
- Navigation with back button via Adw.NavigationView
